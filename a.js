let a = [
    {
        id: 767,
        created_at: '2024-01-24T13:28:58.918971+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_767',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 768,
        created_at: '2024-01-24T13:29:04.827497+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_768',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 769,
        created_at: '2024-01-24T13:29:05.353007+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_769',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 770,
        created_at: '2024-01-24T13:29:05.966481+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_770',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 771,
        created_at: '2024-01-24T13:29:06.475171+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_771',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    },
    {
        id: 772,
        created_at: '2024-01-24T13:29:07.031655+00:00',
        product_wage_in: 100,
        product_wage: 200,
        product_type: '610',
        product_total_weight: 200,
        product_gold_weight: 100,
        product_stone_weight: 100,
        product_price_import: 3770,
        product_price_export: null,
        product_image_url: 'https://i.ibb.co/8zJ0nVp/a-767.webp',
        product_barcode: '#NC_772',
        product_catalog: 'NC',
        product_status: true,
        product_sell_date: null,
        product_total_price: null,
        product_image_name: 'WDQ6N1w',
        edit_at: null,
        product_import_type: true
    }
]

const product_catalog = [
    {
        name: 'NC',
        fullName: 'Nhẫn Cưới'
    },
    { text: "NHẪN NỮ", value: "NT" },
    { text: "NHẪN CƯỚI", value: "NC" },
    { text: "NHẪN NAM", value: "NN" },
    { text: "BÔNG LỚN", value: "BL" },
    { text: "BÔNG EM BÉ", value: "BE" },
    { text: "DÂY LỚN", value: "DL" },
    { text: "DÂY EM BÉ", value: "DE" },
    { text: "MẶT", value: "MD" },
    { text: "VÒNG TRƠN", value: "VT" },
    { text: "VÒNG KIỂU", value: "VK" },
    { text: "VÒNG EM BÉ", value: "VE" },
    { text: "LẮC LỚN", value: "LL" },
    { text: "LẮC EM BÉ", value: "LE" },
    { text: "KIỀNG 18K", value: "KT" },
    { text: "KIỀNG CƯỚI", value: "KC" },
    { text: "XIMEN", value: "XM" },
    { text: "KHÁC", value: "KK" },

]
//const fields = ['stt', 'ten', 'klt', 'klv', 'klh', 'c', 'cty', 'mavach', 'loaivang'];
const option = [
    {
        keyJSON: 'product_catalog', headerName: 'ten',
        formatter: (item) => {
            let fullName = product_catalog.find(x => x.value === item.product_catalog);

            return fullName.text
        }
    },
    {
        keyJSON: 'product_total_weight', headerName: 'klt',
        formatter: (item) => {
            return formatSoVang(item.product_total_weight).fullStr
        }
    },
    {
        keyJSON: 'product_gold_weight', headerName: 'klv',
        formatter: (item) => {
            return formatSoVang(item.product_gold_weight).fullStr
        }
    },
    {
        keyJSON: 'product_stone_weight', headerName: 'klh',
        formatter: (item) => {
            return formatSoVang(item.product_stone_weight).fullStr
        }
    },
    {
        keyJSON: 'product_wage', headerName: 'c'
    },

    {
        keyJSON: 'product_import_type', headerName: 'cty',
        formatter: (item) => {
            return item.product_import_type ? 'Cty' : 'Nội Bộ'
        }
    },
    {
        keyJSON: 'product_barcode', headerName: 'mavach',

    },
    {
        keyJSON: 'product_type', headerName: 'loaivang',

    },

]
const { printTable } = require('console-table-printer');

let result = json2csv(a, option, ",")

printTable(a.map((item, index) => {
    return {
        stt: index + 1,
        'Mã DB': item.id,
        'Mã Vạch': item.product_barcode,
        'Trọng Lượng Tổng': formatSoVang(item.product_total_weight).fullStr,
        'Trọng Lượng Hột': formatSoVang(item.product_stone_weight).fullStr,
        'Trọng Lượng Vàng': formatSoVang(item.product_gold_weight).fullStr,
        'Tiền Công': item.product_wage,
        'Chành': item.product_import_type ? 'Cty' : 'Nội Bộ',
    }
}));
function json2csv(jsonFile, options, delimiter = ',') {
    // Thêm 'index' vào tiêu đề
    const headers = ['index'].concat(options.map(opt => opt.headerName)).join(delimiter);

    // Tạo từng dòng dữ liệu, bao gồm cả index
    const rows = jsonFile.map((item, index) => {
        // Tạo mảng dữ liệu từ các option, bắt đầu bằng index
        const data = [index + 1].concat(options.map(opt => {
            // Áp dụng hàm formatter nếu có, ngược lại lấy giá trị trực tiếp từ jsonFile
            return opt.formatter ? opt.formatter(item) : item[opt.keyJSON];
        }));

        return data.join(delimiter);
    }).join('\n');

    // Kết hợp tiêu đề và dữ liệu
    return headers + '\n' + rows;
}
function formatSoVang(t) {
    if (0 == t || null == t || null == t)
        return {
            fullStr: 0,
            raw: 0
        };
    var e = String(t);
    let fullStr = t >= 1e4 ? e.toString().replace(/\B(?=(\d{4})+(?!\d))/g, "L") : 1e3 <= t && t < 1e4 ? e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "c") : 100 <= t < 1e3 ? e.toString().replace(/\B(?=(\d{2})+(?!\d))/g, "p") : void 0
    let objectFormat = {
        fullStr,
        raw: parseInt(t)
    }
    return objectFormat
}